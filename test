/*
Created: 02/05/2022
Modified: 02/05/2022
Model: MySQL 8.0
Database: MySQL 8.0
*/

-- Create tables section -------------------------------------------------

-- Table users

CREATE TABLE `users`
(
  `user_id` Int NOT NULL,
  `name` Char(20),
  `email` Char(20),
  `password` Char(20)
)
;

ALTER TABLE `users` ADD PRIMARY KEY (`user_id`)
;

ALTER TABLE `users` ADD UNIQUE `user_id` (`user_id`)
;

-- Table movies

CREATE TABLE `movies`
(
  `movie_id` Int NOT NULL,
  `name` Char(20),
  `desc` Char(20),
  `image` Char(20),
  `length` Double
)
;

ALTER TABLE `movies` ADD PRIMARY KEY (`movie_id`)
;

ALTER TABLE `movies` ADD UNIQUE `movie_id` (`movie_id`)
;

-- Table rooms

CREATE TABLE `rooms`
(
  `room_id` Int NOT NULL,
  `name` Char(20),
  `number_of_seats` Int
  `type` Char(20)
)
;

ALTER TABLE `rooms` ADD PRIMARY KEY (`room_id`)
;

ALTER TABLE `rooms` ADD UNIQUE `theater_id` (`room_id`)
;

-- Table shows

CREATE TABLE `shows`
(
  `show_id` Int NOT NULL,
  `time` Datetime,
  `room_id` Int,
  `movie_id` Int
)
;

CREATE INDEX `IX_Relationship1` ON `shows` (`room_id`)
;

CREATE INDEX `IX_Relationship2` ON `shows` (`movie_id`)
;

ALTER TABLE `shows` ADD PRIMARY KEY (`show_id`)
;

ALTER TABLE `shows` ADD UNIQUE `show_id` (`show_id`)
;

-- Table bookings

CREATE TABLE `bookings`
(
  `book_id` Int NOT NULL,
  `user_id` Int,
  `show_id` Int
)
;

CREATE INDEX `IX_Relationship3` ON `bookings` (`user_id`)
;

CREATE INDEX `IX_Relationship4` ON `bookings` (`show_id`)
;

ALTER TABLE `bookings` ADD PRIMARY KEY (`book_id`)
;

ALTER TABLE `bookings` ADD UNIQUE `book_id` (`book_id`)
;

-- Create foreign keys (relationships) section -------------------------------------------------

ALTER TABLE `shows` ADD CONSTRAINT `Relationship1` FOREIGN KEY (`room_id`) REFERENCES `rooms` (`room_id`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `shows` ADD CONSTRAINT `Relationship2` FOREIGN KEY (`movie_id`) REFERENCES `movies` (`movie_id`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `bookings` ADD CONSTRAINT `Relationship3` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `bookings` ADD CONSTRAINT `Relationship4` FOREIGN KEY (`show_id`) REFERENCES `shows` (`show_id`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

